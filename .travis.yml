 
language: android
jdk: oraclejdk8

sudo: false

cache:
  directories:
    - ${TRAVIS_BUILD_DIR}/gradle/caches/
    - ${TRAVIS_BUILD_DIR}/gradle/wrapper/dists/

android:
  components:
    - tools
    - platform-tools
before_script:
  - ./gradlew androidDependencies

  - echo "y" | sdkmanager "emulator" "extras;google;google_play_services" "extras;google;m2repository" "extras;android;m2repository" "build-tools;27.0.3" "platform-tools" "platforms;android-24" "platforms;android-27" "system-images;android-24;default;armeabi-v7a"
  - echo "y" | sdkmanager --update

  - echo "no" | android create avd --force -n test -k "system-images;android-24;default;armeabi-v7a"
  #- export ANDROID_SDK_ROOT=/usr/local/android-sdk

  - export QEMU_AUDIO_DRV=none
  - export LD_LIBRARY_PATH=${ANDROID_HOME}/emulator/lib64:${ANDROID_HOME}/emulator/lib64/qt/lib
  - $ANDROID_HOME/emulator/emulator -avd test -noaudio  -no-boot-anim -no-window -accel on -use-system-libs -verbose &

  #- echo no | android create avd --force -n test -k "system-images;android-${EMULATOR_API_LEVEL};${ANDROID_TAG};${ANDROID_ABI}" 
  #- /usr/local/android-sdk/emulator/emulator -avd test -no-skin -no-window -engine classic &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &



script:
  #- ./gradlew clean check connectedCheck
  - "travis_wait 30 sleep 1800 &"
  - ./gradlew clean lint test check connectedCheck --info --stacktrace
  #connectedAndroidTest
